<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mathilde Duclos">
<meta name="author" content="Lily Houles">
<meta name="author" content="Adèle Kieffer">
<meta name="author" content="Lokian Le Gal-Audebourg">
<meta name="author" content="Valentin Lucas">
<meta name="author" content="Lyssandre Marchand">
<meta name="author" content="Quentin Petitjean">

<title>GENERAL LINEAR MODEL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-169b6d0432b1a799c6e7691d07d1a7fb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="theme.scss">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MarieEtienne/stats-reminders"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructions.html"> 
<span class="menu-text">Instructions</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-two-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Two examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-two-examples">    
        <li>
    <a class="dropdown-item" href="./r_chapter.html">
 <span class="dropdown-text">Basic quarto cross ref example</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Penguins_chapter.html">
 <span class="dropdown-text">Penguins example</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-linear-model" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Linear Model</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-linear-model">    
        <li>
    <a class="dropdown-item" href="./Linear_Model_1.html">
 <span class="dropdown-text">General Linear Model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Linear_Model_2.html">
 <span class="dropdown-text">Generalized Linear Mixed Model</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-factorial-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Factorial Analysis</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-factorial-analysis">    
        <li class="dropdown-header">pca.qmd</li>
        <li class="dropdown-header">cca.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-differential-equation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Differential Equation</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-differential-equation">    
        <li>
    <a class="dropdown-item" href="./EDO_estimation.html">
 <span class="dropdown-text">EDO Estimation of parameters : the logistic growth</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./EDO_LOKTA_VOLTERA.html">
 <span class="dropdown-text">EDO prédation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-introduction" id="toc-general-introduction" class="nav-link active" data-scroll-target="#general-introduction"><strong>GENERAL INTRODUCTION</strong></a>
  <ul class="collapse">
  <li><a href="#generalities" id="toc-generalities" class="nav-link" data-scroll-target="#generalities"><strong>Generalities</strong></a></li>
  <li><a href="#types-of-general-linear-models" id="toc-types-of-general-linear-models" class="nav-link" data-scroll-target="#types-of-general-linear-models"><strong>Types of General Linear Models</strong></a></li>
  </ul></li>
  <li><a href="#data-presentation-and-objectives" id="toc-data-presentation-and-objectives" class="nav-link" data-scroll-target="#data-presentation-and-objectives"><strong>DATA PRESENTATION AND OBJECTIVES</strong></a>
  <ul class="collapse">
  <li><a href="#import-useful-libraries" id="toc-import-useful-libraries" class="nav-link" data-scroll-target="#import-useful-libraries"><strong>Import useful libraries</strong></a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import"><strong>Data import</strong></a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><strong>Data exploration</strong></a>
  <ul class="collapse">
  <li><a href="#outliers-and-distribution-of-the-dependent-variable-y" id="toc-outliers-and-distribution-of-the-dependent-variable-y" class="nav-link" data-scroll-target="#outliers-and-distribution-of-the-dependent-variable-y"><strong>1. Outliers and distribution of the dependent variable</strong> (<span class="math inline">\(Y\)</span>)</a></li>
  <li><a href="#outliers-and-distributions-of-quantitative-predictors-x" id="toc-outliers-and-distributions-of-quantitative-predictors-x" class="nav-link" data-scroll-target="#outliers-and-distributions-of-quantitative-predictors-x"><strong>2. Outliers and Distributions of Quantitative Predictors (</strong><span class="math inline">\(X\)</span><strong>)</strong></a></li>
  <li><a href="#number-of-levels-and-individuals-per-level-of-qualitative-predictors-x" id="toc-number-of-levels-and-individuals-per-level-of-qualitative-predictors-x" class="nav-link" data-scroll-target="#number-of-levels-and-individuals-per-level-of-qualitative-predictors-x"><strong>3. Number of Levels and Individuals per Level of Qualitative Predictors (</strong><span class="math inline">\(X\)</span><strong>)</strong></a></li>
  <li><a href="#analysis-of-the-potential-relationships-between-y-and-the-xs" id="toc-analysis-of-the-potential-relationships-between-y-and-the-xs" class="nav-link" data-scroll-target="#analysis-of-the-potential-relationships-between-y-and-the-xs"><strong>4. Analysis of the Potential Relationships Between</strong> <span class="math inline">\(Y\)</span> <strong>and the</strong> <span class="math inline">\(Xs\)</span></a></li>
  <li><a href="#analysis-of-possible-interactions-between-both-independent-variables" id="toc-analysis-of-possible-interactions-between-both-independent-variables" class="nav-link" data-scroll-target="#analysis-of-possible-interactions-between-both-independent-variables"><strong>5. Analysis of possible interactions between both independent variables</strong></a></li>
  <li><a href="#check-for-collinearity-between-predictors-xs" id="toc-check-for-collinearity-between-predictors-xs" class="nav-link" data-scroll-target="#check-for-collinearity-between-predictors-xs"><strong>6. Check for collinearity between predictors (</strong><span class="math inline">\(Xs\)</span><strong>)</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-and-statistical-analysis" id="toc-model-and-statistical-analysis" class="nav-link" data-scroll-target="#model-and-statistical-analysis"><strong>MODEL AND STATISTICAL ANALYSIS</strong></a>
  <ul class="collapse">
  <li><a href="#construction-of-the-model" id="toc-construction-of-the-model" class="nav-link" data-scroll-target="#construction-of-the-model"><strong>1. Construction of the model</strong></a></li>
  <li><a href="#variable-selection" id="toc-variable-selection" class="nav-link" data-scroll-target="#variable-selection"><strong>2. Variable selection</strong></a></li>
  <li><a href="#validation-of-the-model" id="toc-validation-of-the-model" class="nav-link" data-scroll-target="#validation-of-the-model"><strong>3. Validation of the model</strong></a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><strong>DISCUSSION</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>CONCLUSION</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>REFERENCES</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GENERAL LINEAR MODEL</h1>
<p class="subtitle lead">PENGUINS EXAMPLE</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Mathilde Duclos </p>
             <p>Lily Houles </p>
             <p>Adèle Kieffer </p>
             <p>Lokian Le Gal-Audebourg </p>
             <p>Valentin Lucas </p>
             <p>Lyssandre Marchand </p>
             <p>Quentin Petitjean </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="general-introduction" class="level1">
<h1><strong>GENERAL INTRODUCTION</strong></h1>
<div id="GLM">
<p>We present here, a reminder sheet on the <strong>General Linear Model <a href="#GLMback">(GLM)</a></strong> and its specific features. Its use will be illustrated with an example applied to ecological data on penguins from <span class="citation" data-cites="Gorman2014">Gorman, Williams, and Fraser (<a href="#ref-Gorman2014" role="doc-biblioref">2014</a>)</span> .</p>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The concepts covered in this reminder sheet are taken from our Master’s lectures, written by <span class="citation" data-cites="Y_Outreman">Outreman (<a href="#ref-Y_Outreman" role="doc-biblioref">n.d.</a>)</span> and then taught by <span class="citation" data-cites="A_Masson">Masson (<a href="#ref-A_Masson" role="doc-biblioref">n.d.</a>)</span> . During these courses, we learned how to explore data and then analyze it using this type of model.</p>
</div>
</div>
<section id="generalities" class="level2">
<h2 class="anchored" data-anchor-id="generalities"><strong>Generalities</strong></h2>
<div id="GLMback">
<p>The objective of the <a href="#GLM">GLM</a> is to explain a dependent variable as a function of independent explanatory variables measured on statistical units from a sample of a population. This type of model is generally constructed as follows:</p>
</div>
<p><span class="math display">\[Y = β*X + ε\]</span></p>
<p><span class="math inline">\(Y\)</span> is the response (dependent) variable to be explained. <span class="math inline">\(X\)</span> is an explanatory (independent) variable that can explain <span class="math inline">\(Y\)</span>. There can be several explanatory variables in the model. β represents a coefficient, placed in front of the <span class="math inline">\(X\)</span> variables, to measure their effect on the response variable. ε represents the errors in the model, i.e.&nbsp;what the model cannot explain.</p>
</section>
<section id="types-of-general-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="types-of-general-linear-models"><strong>Types of General Linear Models</strong></h2>
<p>There are three general types of linear models:</p>
<ul>
<li><strong>Linear regression</strong></li>
<li><strong>Analysis of variance (ANOVA)</strong></li>
<li><strong>Analysis of variance-covariance (ANCOVA)</strong></li>
</ul>
<p>They each have their own specific characteristics and depend on the nature of the independent variables <span class="math inline">\(X\)</span>, which can be quantitative or qualitative. The response variable <span class="math inline">\(Y\)</span> is always quantitative.</p>
<p>Linear regression is used when we want to determine whether a linear relationship exists between the response variable <span class="math inline">\(Y\)</span> and one or more quantitative <span class="math inline">\(X\)</span> variables (then called covariates).</p>
<p>ANOVA is used when the explanatory variables <span class="math inline">\(X\)</span> are qualitative (then called factors). These qualitative <span class="math inline">\(X\)</span> variables often have multiple categories (levels).</p>
<div id="ANCOVA">
<p><a href="#ANCOVAback">ANCOVA</a> is used when we want to model the variable <span class="math inline">\(Y\)</span> as a function of several <span class="math inline">\(X\)</span> variables, which can be qualitative and quantitative.</p>
</div>
<div id="conditions">
<p>Another important aspect to consider is that for this type of model to be valid, three <a href="#conditionsBACK">conditions</a> must be met:</p>
</div>
<ul>
<li><p>the model residuals must follow a <strong>normal distribution</strong></p></li>
<li><p><strong>homoscedasticity</strong> (homogeneity of the variance of the residuals) must be respected</p></li>
<li><p>the residuals are <strong>independent</strong></p></li>
</ul>
<p>These conditions are systematically verified after modelling : the verification will be illustrated in the following example.</p>
</section>
</section>
<section id="data-presentation-and-objectives" class="level1">
<h1><strong>DATA PRESENTATION AND OBJECTIVES</strong></h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/penguin1.jpg" class="img-fluid figure-img"></p>
<figcaption>Gentoo penguins - image from Pixabay</figcaption>
</figure>
</div>
<p>In this application example, we will use data from a study conducted by Dr.&nbsp;Kristen Gorman, who studied the <strong>physical characteristics of three species of penguins</strong> in the Palmer Archipelago in Antarctica. The data was collected on three islands of the archipelago in 2007, 2008, and 2009.</p>
<p>The researcher noted the following characteristics in the individuals studied:</p>
<ul>
<li><code>species</code> : species of individuals, qualitative variables, 3 levels (Adelie, Gentoo, Chinstrap)</li>
<li><code>sex</code> : sex of individuals, qualitative variables, 2 levels (male, female)</li>
<li><code>bill_length_mm</code> : bill length, quantitative variable</li>
<li><code>bill_depth_mm</code> : bill depth, quantitative variable</li>
<li><code>flipper_length_mm</code> : flipper length, quantitative variable</li>
<li><code>body_mass_g</code> : body mass, quantitative variable</li>
</ul>
<p>We also have information about the year of measurement and the island where the individuals live. We decide not to focus on these variables while studying the model. Indeed, we choose to focus our study on biological and morphological characteristics.</p>
<p>We will try to answer the following question : <strong>Which quantitative and qualitative variables can explain the variation in penguin <code>body_mass_g</code>?</strong></p>
<div id="ANCOVAback">
<p>In this case, the response variable is <code>body_mass_g</code>, and the other variables are assumed to be explanatory variables. We want to model the variable <span class="math inline">\(Y\)</span> as a function of several qualitative and quantitative variables, therefore we do an <a href="#ANCOVA">ANCOVA</a>.</p>
</div>
<p>The model can be build like this : model &lt;- <strong>lm (<code>body_mass_g</code> ~ <code>...</code>, data = <code>penguins</code>)</strong></p>
<section id="import-useful-libraries" class="level2">
<h2 class="anchored" data-anchor-id="import-useful-libraries"><strong>Import useful libraries</strong></h2>
<p>Here we import the libraries we will use during the analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
</div>
</section>
<section id="data-import" class="level2">
<h2 class="anchored" data-anchor-id="data-import"><strong>Data import</strong></h2>
<p>Firstly, we need to import the data, explore it, and see if there are any NA values, outliers, and so on. The data is accessible via the package <em>palmerpenguins</em> by <span class="citation" data-cites="Horst2020">Horst, Hill, and Gorman (<a href="#ref-Horst2020" role="doc-biblioref">2020</a>)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"penguins"</span>) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change categorical variables as factor </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>sex<span class="ot">&lt;-</span><span class="fu">as.factor</span>(penguins<span class="sc">$</span>sex) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>species<span class="ot">&lt;-</span><span class="fu">as.factor</span>(penguins<span class="sc">$</span>species)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for presence of missing values </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(penguins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          species            island    bill_length_mm     bill_depth_mm 
                0                 0                 2                 2 
flipper_length_mm       body_mass_g               sex              year 
                2                 2                11                 0 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(penguins<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>female   male   NA's 
   165    168     11 </code></pre>
</div>
</div>
<p>There are NA values in the dataset. Two rows contain missing values for all variables, except <code>species</code>. Values are missing for the variable <code>sex</code> in nine additional rows. There are different ways to process NA values. We decide to delete the two rows where almost all information is missing. Then, one option would be to replace the other missing values for the <code>sex</code> variable by “unknown” to specify that we don’t know whether the individual is a male or a female and to create a new level for this variable. However, with this option, the group whose sex is unknown would be underrepresented compared to male and female groups. As it seems interesting to test whether being a female or a male has an influence on the body mass of penguins, having rows where the sex of individuals is unknown is not really useful and could add noise to the analysis. Therefore, we decide to delete all rows containing NA values. Moreover, the rows including NA values only represented about 3% of the dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for presence of missing values</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>penguins<span class="ot">&lt;-</span><span class="fu">na.omit</span>(penguins)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(penguins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          species            island    bill_length_mm     bill_depth_mm 
                0                 0                 0                 0 
flipper_length_mm       body_mass_g               sex              year 
                0                 0                 0                 0 </code></pre>
</div>
</div>
<p>We now have handled NA values and can continue to explore the data before implementing the model to answer our question.</p>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration"><strong>Data exploration</strong></h2>
<p><strong>Data exploration</strong> is always the first step before analysis and model creation. This step is essential for identifying the structure of variables and checking for outliers, correlations, unbalanced distributions that could bias the results of the analysis.</p>
<section id="outliers-and-distribution-of-the-dependent-variable-y" class="level3">
<h3 class="anchored" data-anchor-id="outliers-and-distribution-of-the-dependent-variable-y"><strong>1. Outliers and distribution of the dependent variable</strong> (<span class="math inline">\(Y\)</span>)</h3>
<p><span class="math inline">\(Y\)</span> (i.e <code>body_mass_g</code> ) is a continuous quantitative variable. Let’s take a look at its distribution, using the following graphs.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),      </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>),           </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg=</span><span class="st">"gray95"</span>,              </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.axis=</span><span class="st">"gray20"</span>,      </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.lab=</span><span class="st">"gray20"</span>,     </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.main=</span><span class="st">"gray20"</span>,     </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">0.9</span>,      </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="dv">1</span>) </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>col_transp <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(<span class="st">"aquamarine3"</span>, <span class="at">alpha.f=</span><span class="fl">0.5</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>body_mass_g,         </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>col_transp, <span class="at">border=</span><span class="st">"gray30"</span>,         </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">'Body Mass (g)'</span>,         </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Boxplot'</span>,         </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">notch=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(penguins<span class="sc">$</span>body_mass_g,          </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>col_transp,          </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">'Body Mass (g)'</span>,          </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">'Cleveland plot'</span>,          </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(penguins<span class="sc">$</span>body_mass_g,      </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span>col_transp, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="st">"white"</span>,      </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Body Mass (g)"</span>,      </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">'Histogram'</span>,      </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot </span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>col_transp, <span class="at">xlab=</span><span class="st">''</span>, <span class="at">ylab=</span><span class="st">''</span>,<span class="at">main=</span><span class="st">"QQ plot"</span>) </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-distrib-bodymass" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distrib-bodymass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_response_variable-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-distrib-bodymass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>Based on the Boxplot, Cleveland plot and Histogram (<a href="#fig-distrib-bodymass" class="quarto-xref">Figure&nbsp;1</a>), it seems that there are no outliers in the <span class="math inline">\(Y\)</span> variable <code>body_mass_g</code>. With the Q-Q plot, the data appears to follow a Gaussian distribution. However, <span class="math inline">\(Y\)</span> normality is not a required assumption for our model. Keep in mind that we will need to check something about normality later on : the model residuals must follow a normal distribution in the case of a linear model.</p>
</section>
<section id="outliers-and-distributions-of-quantitative-predictors-x" class="level3">
<h3 class="anchored" data-anchor-id="outliers-and-distributions-of-quantitative-predictors-x"><strong>2. Outliers and Distributions of Quantitative Predictors (</strong><span class="math inline">\(X\)</span><strong>)</strong></h3>
<p>We also take a look at the distribution of <span class="math inline">\(Xs\)</span>, using the same graphs.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Don't show the code </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),      </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>),           </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg=</span><span class="st">"gray95"</span>,              </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.axis=</span><span class="st">"gray20"</span>,      </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.lab=</span><span class="st">"gray20"</span>,      </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.main=</span><span class="st">"gray20"</span>,      </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">0.9</span>,      </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab=</span><span class="dv">1</span>) </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>col_transp <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(<span class="st">"darkgreen"</span>, <span class="at">alpha.f=</span><span class="fl">0.5</span>)  </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Bill lenght  </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_length_mm,         </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>col_transp, <span class="at">border=</span><span class="st">"gray30"</span>,         </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">'Bill Length'</span>,         </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Boxplot'</span>,         </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">notch=</span><span class="cn">TRUE</span>) </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(penguins<span class="sc">$</span>bill_length_mm,          </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,          </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>col_transp,          </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">'Bill Length'</span>,          </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">'Cleveland plot'</span>) </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(penguins<span class="sc">$</span>bill_length_mm,      </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span>col_transp,      </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Bill Length"</span>,      </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram"</span>) </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot </span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins<span class="sc">$</span>bill_length_mm,        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>col_transp,<span class="at">xlab=</span><span class="st">''</span>,         </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">'QQ plot'</span>) </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins<span class="sc">$</span>bill_length_mm,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bill depth</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_depth_mm,         </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>col_transp, <span class="at">border=</span><span class="st">"gray30"</span>,         </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">'Bill Depth'</span>,         </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Boxplot'</span>,         </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">notch=</span><span class="cn">TRUE</span>) </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(penguins<span class="sc">$</span>bill_depth_mm,          </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,          </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>col_transp,          </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">'Bill Depth'</span>,          </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">'Cleveland plot'</span>) </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(penguins<span class="sc">$</span>bill_depth_mm,      </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span>col_transp,     </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Bill Depth"</span>,      </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram"</span>) </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot </span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins<span class="sc">$</span>bill_depth_mm,        </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>,        </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>col_transp,<span class="at">xlab=</span><span class="st">''</span>,        </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">'QQ plot'</span>) </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins<span class="sc">$</span>bill_depth_mm,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flipper lenght  </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>flipper_length_mm,         </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span>col_transp, <span class="at">border=</span><span class="st">"gray30"</span>,         </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">'Flipper Length'</span>,         </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Boxplot'</span>,         </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">notch=</span><span class="cn">TRUE</span>) </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(penguins<span class="sc">$</span>flipper_length_mm,          </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,          </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>col_transp,          </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">'Flipper Length'</span>,          </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">'Cleveland plot'</span>) </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(penguins<span class="sc">$</span>flipper_length_mm,      </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span>col_transp,      </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Flipper Length"</span>,      </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram"</span>) </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot </span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins<span class="sc">$</span>flipper_length_mm,        </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">16</span>,        </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>col_transp,<span class="at">xlab=</span><span class="st">''</span>,        </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">'QQ plot'</span>) </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins<span class="sc">$</span>flipper_length_mm,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-quantitative-explanatory-var" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quantitative-explanatory-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_quantitative_explanatory_variables-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_quantitative_explanatory_variables-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_quantitative_explanatory_variables-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-quantitative-explanatory-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
<p>There appear to be no outliers for any of the quantitative variables.</p>
<p>Let’s describe what we observe while looking at the graphs in <a href="#fig-quantitative-explanatory-var" class="quarto-xref">Figure&nbsp;2</a>. From the Cleveland plot, for the bill length variable, we can observe two distinct clusters which might be related to sexual dimorphism. For the bill depth, 3 clusters are observed on the Cleveland Plot : this variable might be related to the difference of bill depth between species. For flipper length, the Cleveland plot also reveals three distinct clusters. All these variables seem to follow a Gaussian distribution. Visualizing the distributions of the quantitative <span class="math inline">\(X\)</span> variables allows us to formulate hypotheses regarding species differences and sexual dimorphism.</p>
</section>
<section id="number-of-levels-and-individuals-per-level-of-qualitative-predictors-x" class="level3">
<h3 class="anchored" data-anchor-id="number-of-levels-and-individuals-per-level-of-qualitative-predictors-x"><strong>3. Number of Levels and Individuals per Level of Qualitative Predictors (</strong><span class="math inline">\(X\)</span><strong>)</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(penguins<span class="sc">$</span>species) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Adelie Chinstrap    Gentoo 
      146        68       119 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(penguins<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>female   male 
   165    168 </code></pre>
</div>
</div>
<p>For the <code>species</code> variable, Chinstrap is a bit under-represented in comparison to other species. We will keep the variable for the model as it may capture important differences between groups. For the <code>sex</code> variable, the number of observations is almost equivalent for the male and female groups.</p>
</section>
<section id="analysis-of-the-potential-relationships-between-y-and-the-xs" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-the-potential-relationships-between-y-and-the-xs"><strong>4. Analysis of the Potential Relationships Between</strong> <span class="math inline">\(Y\)</span> <strong>and the</strong> <span class="math inline">\(Xs\)</span></h3>
<p>Now, we can explore the potential relationship between the response variable <span class="math inline">\(Y\)</span> (<code>body_mass_g</code>) and the <span class="math inline">\(Xs\)</span> variables. Keep in mind that this part of the analysis is based on graphs and doesn’t tell us if the relationships between variables are significant or not.</p>
<div id="fig-relation-XY" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-relation-XY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_exploration_relation-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-relation-XY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
<p>Looking at these graphs (<a href="#fig-relation-XY" class="quarto-xref">Figure&nbsp;3</a>), there appears to be a positive linear relationship between body mass and other quantitative variables. A sexual dimorphism is observed : females tend to have a lower body mass than males. In addition, there may be species differences : Gentoo penguins appear to have higher body mass compared to Adelie and Chinstrap penguins, which have similar body mass measurements.</p>
</section>
<section id="analysis-of-possible-interactions-between-both-independent-variables" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-possible-interactions-between-both-independent-variables"><strong>5. Analysis of possible interactions between both independent variables</strong></h3>
<p>This section aims to check for potential interaction effects between the two qualitative variables. To do so, all combinations of their categories must be present in the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>species, penguins<span class="sc">$</span>sex) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            female male
  Adelie        73   73
  Chinstrap     34   34
  Gentoo        58   61</code></pre>
</div>
</div>
<p>All categories are present and well balanced across the factors, allowing us to test for potential interactions between them.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>sex<span class="sc">*</span>penguins<span class="sc">$</span>species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Body Mass"</span>, <span class="at">col=</span><span class="st">'green4'</span>, <span class="at">main =</span> <span class="st">""</span>,<span class="at">cex.axis=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_interaction_qualitative-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Males appear to have a higher body mass than females for the three species. The difference between males and females may vary a little depending on the species. There may be a small interaction between the tow factors <code>sex</code> and <code>species</code>.</p>
<p>Then, we also check for potential interactions between explanatory quantitative variables and explanatory qualitative variables, using the following graphs.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Bill Length &amp; Sex </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Bill Length"</span>) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"male"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"male"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#E69F00'</span>) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#CC79A7'</span>)  </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Bill Length &amp; Species </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Bill Length"</span>) </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>],<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">'#FDE725'</span>) </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#35B779'</span>) </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#31688E'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Bill Depth &amp; Sex </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Bill Depth"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"male"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"male"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#E69F00'</span>) </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#CC79A7'</span>)  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Bill Depth &amp; Species </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Bill Depth"</span>) </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>],<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">'#FDE725'</span>) </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#35B779'</span>) </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>bill_depth_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#31688E'</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Flipper Length &amp; Sex </span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Flipper Length"</span>) </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex <span class="sc">==</span><span class="st">"male"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"male"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#E69F00'</span>) </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm[penguins<span class="sc">$</span>sex<span class="sc">==</span><span class="st">"female"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#CC79A7'</span>)  </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Flipper Length &amp; Species </span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins<span class="sc">$</span>body_mass_g<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Body Mass"</span>,<span class="at">xlab=</span><span class="st">"Flipper Length"</span>) </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>],<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">'#FDE725'</span>) </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'#35B779'</span>) </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(penguins<span class="sc">$</span>body_mass_g[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>]<span class="sc">~</span>penguins<span class="sc">$</span>flipper_length_mm[penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">'#31688E'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-interactions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_interaction_qualitative_quantitative-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-interactions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4
</figcaption>
</figure>
</div>
<p>Here are our observations regarding possible interactions, based on the graphs of <a href="#fig-interactions" class="quarto-xref">Figure&nbsp;4</a> :</p>
<p>Bill length and sex : there is a possible interaction. For some values of bill length, body mass is higher for males than females but for some values the opposite is true and females have a higher body mass than males.</p>
<p>Bill length and species : there are three color clusters that do not appear to mix on the graph. Individuals of the Gentoo species appear to have a higher body mass than the other species, but sometimes slightly lower depending on bill length values. A small interaction is possible.</p>
<p>Bill depth and sex : there appears to be no interaction between bill depth and sex. The relation between body mass and bill depth is the same for males and females and males body mass is higher than females body mass.</p>
<p>Bill depth and species : there appears to be no interaction between bill depth and species. The relation between body mass and bill depth observed previously during the data exploration is the same and the Gentoo species still stands out in terms of body mass : individuals of the Gentoo species still appear to have a higher body mass than the other species.</p>
<p>Flipper length and sex : there is a possible interaction. Body mass appears to increase with flipper length but for some values of flipper length, females can have a higher body mass than males.</p>
<p>Flipper length and species : there appears to be no interaction between flipper length and species. The relation between body mass and bill length observed previously during the data exploration is the same regardless the species and the Gentoo species still stands out in terms of body mass, which remains higher than the body of the other species on the graph.</p>
<p>These are only observations. For the moment, we don’t know which interactions are significant. This will be tested afterwards.</p>
</section>
<section id="check-for-collinearity-between-predictors-xs" class="level3">
<h3 class="anchored" data-anchor-id="check-for-collinearity-between-predictors-xs"><strong>6. Check for collinearity between predictors (</strong><span class="math inline">\(Xs\)</span><strong>)</strong></h3>
<p>Collinearity should be avoided in modelling. Indeed, it can affect the modelling and the significance of the variables in the model, which affects the conclusions. Let’s check how the explanatory variables are related (<a href="#fig-collinearity" class="quarto-xref">Figure&nbsp;5</a>).</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking collinearity between continuous independent variables</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penguins[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'darkolivegreen4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">cor</span>(penguins[,<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(M,<span class="at">upper=</span><span class="st">"square"</span>,<span class="at">lower.col=</span><span class="st">"black"</span>, <span class="at">tl.col=</span><span class="st">"black"</span>,<span class="at">cl.cex =</span> <span class="fl">0.8</span>,<span class="at">tl.cex =</span> <span class="fl">0.7</span>,<span class="at">number.cex =</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking collinearity between categorical and continuous independent variables</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Bill Length and Sex</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_length_mm<span class="sc">~</span>penguins<span class="sc">$</span>sex, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Bill Length"</span>, <span class="at">xlab =</span> <span class="st">"Sex"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Bill Depth and Sex</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_depth_mm<span class="sc">~</span>penguins<span class="sc">$</span>sex, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Bill Depth"</span>, <span class="at">xlab =</span> <span class="st">"Sex"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Flipper Length and Sex</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>flipper_length_mm<span class="sc">~</span>penguins<span class="sc">$</span>sex, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Flipper Length"</span>, <span class="at">xlab =</span> <span class="st">"Sex"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Bill Length and Species</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_length_mm<span class="sc">~</span>penguins<span class="sc">$</span>species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Bill Length"</span>, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Bill Depth and Species</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>bill_depth_mm<span class="sc">~</span>penguins<span class="sc">$</span>species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Bill Depth"</span>, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Flipper Length and Species</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(penguins<span class="sc">$</span>flipper_length_mm<span class="sc">~</span>penguins<span class="sc">$</span>species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Flipper Length"</span>, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">col=</span><span class="st">'grey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-collinearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-collinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_collinearity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_collinearity-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/data_collinearity-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-collinearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
<p>This verification of collinearity between <span class="math inline">\(Xs\)</span> revealed a positive correlation between Flipper Length and Bill Length. The coefficient is below the threshold of 0.7, so we will not exclude any of these variables.</p>
<p>Note : In some cases, there may be a strong correlation between a specific variable and some other variables, with a high correlation coefficient (above 0.7, which is the threshold set in most cases). This situation can lead you to exclude this specific variable to avoid collinearity but you always need to justify your choice.</p>
<p>As for the other variables : For bill length, bill depth and flipper length, we observe a small difference between males and females. It appears that Adelie penguins have a shorter bill length than to the two other species. It appears that Gentoo penguins have a smaller bill depth and bigger flipper length than the other species.</p>
</section>
</section>
</section>
<section id="model-and-statistical-analysis" class="level1">
<h1><strong>MODEL AND STATISTICAL ANALYSIS</strong></h1>
<p>Let’s recall our research question : we would like to identify the quantitative and qualitative variables that can explain the variation in penguin <code>body_mass_g</code>.</p>
<p>Once the data exploration is done, we can focus on finding the model that is adapted to our study. First, we write a full model including all variables presented before and possible interactions between them. Then, the goal is to obtain a fitted model (candidate model) that we can analyze in order to identify the main effects on our response variable <code>body_mass_g</code> and answer our research question. This candidate model can be obtained thanks to a selection based on <strong>Akaike Information Criterion (AIC)</strong>.</p>
<div id="conditionsBACK">
<p>After selection, the <a href="#conditions">conditions</a> of the linear model must be validated before making interpretations and conclusions.</p>
</div>
<section id="construction-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="construction-of-the-model"><strong>1. Construction of the model</strong></h3>
<p>Firstly, let’s write the full model, including all variables and possible interactions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod_penguins<span class="ot">&lt;-</span><span class="fu">lm</span>(body_mass_g <span class="sc">~</span> bill_length_mm</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> bill_depth_mm</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> flipper_length_mm</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> species</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> sex</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> sex <span class="sc">:</span> species</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> sex <span class="sc">:</span> bill_length_mm</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> sex <span class="sc">:</span> bill_depth_mm</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> sex <span class="sc">:</span> flipper_length_mm</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> species <span class="sc">:</span> bill_length_mm</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> species <span class="sc">:</span> bill_depth_mm</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> species <span class="sc">:</span> flipper_length_mm</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        , <span class="at">data=</span>penguins)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's check for significance</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod_penguins,<span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + sex:species + sex:bill_length_mm + sex:bill_depth_mm + 
    sex:flipper_length_mm + species:bill_length_mm + species:bill_depth_mm + 
    species:flipper_length_mm
                          Df Sum of Sq      RSS    AIC F value  Pr(&gt;F)  
&lt;none&gt;                                 24459504 3767.1                  
species:sex                2    489389 24948893 3769.7  3.1513 0.04415 *
bill_length_mm:sex         1     11498 24471002 3765.2  0.1481 0.70064  
bill_depth_mm:sex          1    265531 24725035 3768.7  3.4196 0.06536 .
flipper_length_mm:sex      1     36725 24496229 3765.6  0.4730 0.49214  
bill_length_mm:species     2      5327 24464832 3763.1  0.0343 0.96628  
bill_depth_mm:species      2      5153 24464657 3763.1  0.0332 0.96737  
flipper_length_mm:species  2    137527 24597032 3764.9  0.8856 0.41350  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="variable-selection" class="level3">
<h3 class="anchored" data-anchor-id="variable-selection"><strong>2. Variable selection</strong></h3>
<p>Now, let’s select the significant terms of the model, based on AIC, using a forward-backward selection method. We can use the stepAIC function from the library MASS to select variables using the AIC. The function tests adding and removing interactions and variables to see which ones improve the AIC. The final model is the one with the lowest AIC.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mod_final <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(mod_penguins, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3767.06
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + sex:species + sex:bill_length_mm + sex:bill_depth_mm + 
    sex:flipper_length_mm + species:bill_length_mm + species:bill_depth_mm + 
    species:flipper_length_mm

                            Df Sum of Sq      RSS    AIC
- bill_depth_mm:species      2      5153 24464657 3763.1
- bill_length_mm:species     2      5327 24464832 3763.1
- flipper_length_mm:species  2    137527 24597032 3764.9
- bill_length_mm:sex         1     11498 24471002 3765.2
- flipper_length_mm:sex      1     36725 24496229 3765.6
&lt;none&gt;                                   24459504 3767.1
- bill_depth_mm:sex          1    265531 24725035 3768.7
- species:sex                2    489389 24948893 3769.7

Step:  AIC=3763.13
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_length_mm:sex + bill_depth_mm:sex + 
    flipper_length_mm:sex + bill_length_mm:species + flipper_length_mm:species

                            Df Sum of Sq      RSS    AIC
- bill_length_mm:species     2      4294 24468950 3759.2
- flipper_length_mm:species  2    160194 24624851 3761.3
- bill_length_mm:sex         1     13815 24478472 3761.3
- flipper_length_mm:sex      1     38162 24502818 3761.7
&lt;none&gt;                                   24464657 3763.1
- bill_depth_mm:sex          1    279275 24743932 3764.9
- species:sex                2    493957 24958614 3765.8
+ bill_depth_mm:species      2      5153 24459504 3767.1

Step:  AIC=3759.19
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_length_mm:sex + bill_depth_mm:sex + 
    flipper_length_mm:sex + flipper_length_mm:species

                            Df Sum of Sq      RSS    AIC
- flipper_length_mm:species  2    162193 24631143 3757.4
- bill_length_mm:sex         1     17259 24486209 3757.4
- flipper_length_mm:sex      1     37020 24505970 3757.7
&lt;none&gt;                                   24468950 3759.2
- bill_depth_mm:sex          1    279677 24748627 3761.0
+ bill_length_mm:species     2      4294 24464657 3763.1
+ bill_depth_mm:species      2      4119 24464832 3763.1
- species:sex                2    713112 25182063 3764.8

Step:  AIC=3757.39
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_length_mm:sex + bill_depth_mm:sex + 
    flipper_length_mm:sex

                            Df Sum of Sq      RSS    AIC
- bill_length_mm:sex         1     10167 24641310 3755.5
- flipper_length_mm:sex      1     29550 24660693 3755.8
&lt;none&gt;                                   24631143 3757.4
- bill_depth_mm:sex          1    266553 24897696 3759.0
+ flipper_length_mm:species  2    162193 24468950 3759.2
- species:sex                2    565896 25197039 3761.0
+ bill_depth_mm:species      2     27765 24603378 3761.0
+ bill_length_mm:species     2      6292 24624851 3761.3

Step:  AIC=3755.53
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_depth_mm:sex + flipper_length_mm:sex

                            Df Sum of Sq      RSS    AIC
- flipper_length_mm:sex      1     37776 24679085 3754.0
&lt;none&gt;                                   24641310 3755.5
- bill_depth_mm:sex          1    257321 24898631 3757.0
+ bill_length_mm:sex         1     10167 24631143 3757.4
+ flipper_length_mm:species  2    155101 24486209 3757.4
+ bill_depth_mm:species      2     27924 24613386 3759.1
+ bill_length_mm:species     2      6041 24635269 3759.4
- bill_length_mm             1    569156 25210466 3761.1
- species:sex                2   1469480 26110790 3770.8

Step:  AIC=3754.04
body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_depth_mm:sex

                            Df Sum of Sq      RSS    AIC
&lt;none&gt;                                   24679085 3754.0
- bill_depth_mm:sex          1    227028 24906114 3755.1
+ flipper_length_mm:sex      1     37776 24641310 3755.5
+ bill_length_mm:sex         1     18392 24660693 3755.8
+ flipper_length_mm:species  2    144807 24534278 3756.1
+ bill_depth_mm:species      2     29046 24650039 3757.6
+ bill_length_mm:species     2      5566 24673520 3758.0
- bill_length_mm             1    624289 25303375 3760.4
- species:sex                2   1492684 26171770 3769.6
- flipper_length_mm          1   2614245 27293330 3785.6</code></pre>
</div>
</div>
<p>We can then use the coefficient given by the model :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)           bill_length_mm            bill_depth_mm 
             -2357.33392                 19.67307                105.46257 
       flipper_length_mm         speciesChinstrap            speciesGentoo 
                16.69243                -87.13281               1088.53204 
                 sexmale speciesChinstrap:sexmale    speciesGentoo:sexmale 
              1605.64215               -360.62936               -173.40442 
   bill_depth_mm:sexmale 
               -64.10611 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ bill_length_mm + bill_depth_mm + flipper_length_mm + 
    species + sex + species:sex + bill_depth_mm:sex, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-733.83 -172.09  -13.83  173.04  851.00 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              -2357.334    689.805  -3.417 0.000713 ***
bill_length_mm              19.673      6.882   2.858 0.004534 ** 
bill_depth_mm              105.463     27.955   3.773 0.000192 ***
flipper_length_mm           16.692      2.854   5.849 1.21e-08 ***
speciesChinstrap           -87.133     85.150  -1.023 0.306941    
speciesGentoo             1088.532    142.221   7.654 2.27e-13 ***
sexmale                   1605.642    682.022   2.354 0.019159 *  
speciesChinstrap:sexmale  -360.629     82.067  -4.394 1.51e-05 ***
speciesGentoo:sexmale     -173.404    144.087  -1.203 0.229674    
bill_depth_mm:sexmale      -64.106     37.190  -1.724 0.085708 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 276.4 on 323 degrees of freedom
Multiple R-squared:  0.8854,    Adjusted R-squared:  0.8822 
F-statistic: 277.1 on 9 and 323 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Some effects are not significant but they were kept in the model with the lowest AIC.</p>
<p>We can write the full model :</p>
<p><span class="math display">\[ Body\:mass = -2357,33 \:+\: 19,67.Bill\:length\:+\: 105,46.Bill\:depth\\ \:+\: 16,69.Flipper\:length \:-\: 87,13.Species\:Chinstrap \:+\: 1088,53.Species\:Gentoo\\ \:+\: 1605,64.Sex\:male \:-\: 360,63.(Species\:Chinstrap:Sex\:male)\\ \:-\: 173,40.(Species\:Gentoo:Sex\:male) \:-\: 63,11.(Bill\:depth:Sex\:male) + ε \]</span></p>
<p>We can check the part of the variance explained by the model, by using the adjusted R^2^. In the summary of the model, the adjusted R^2^ is equal to 0.88. It means that 88% of the variance of the body mass of penguins is explained by the relation given by mod_final.</p>
</section>
<section id="validation-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="validation-of-the-model"><strong>3. Validation of the model</strong></h3>
<p>Let’s check the conditions to validate our model. We need to verify the normality of the residuals, the homogeneity of their variances, and their independence.</p>
<p><strong>Normality of the residuals</strong></p>
<p>The normality of the residuals can be verified using a histogram and a QQ plot of the residuals. The histogram of the residuals must correspond to a normal distribution. The points of the QQ plot must lie primarily on the plotted line. If these conditions are met, the residuals are normally distributed.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mod_final<span class="sc">$</span>residuals,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"residuals"</span>,<span class="at">main=</span><span class="st">"Check Normality"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(mod_final<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(mod_final<span class="sc">$</span>residuals,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/normality-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the residuals follow a normal distribution : we can validate the first condition.</p>
<p><strong>Homogeneity of the variance</strong></p>
<p>The hypothesis of the homogeneity of the variance means that the variance of residuals is constant over the entire range of explanatory variables. The residuals must be plotted against the estimated values and against the values of the significant variables. We can validate this hypothesis if the residuals show no trend.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals vs fitted</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span><span class="fu">fitted</span>(mod_final)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>      , <span class="at">col=</span><span class="st">'dodgerblue3'</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>      , <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against Bill length</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span> penguins<span class="sc">$</span>bill_length_mm, </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Bill length"</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against Bill depth</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span> penguins<span class="sc">$</span>bill_depth_mm, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Bill depth"</span>,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against Flipper length</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span> penguins<span class="sc">$</span>flipper_length_mm, </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Flipper length"</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against Species</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span> penguins<span class="sc">$</span>species, </span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Species"</span>,</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against Sex</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod_final)<span class="sc">~</span> penguins<span class="sc">$</span>sex, </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Sex"</span>,</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Linear_Model_1_files/figure-html/homogeneity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graphs show that residuals variances are homogeneous, for all variables. Thus, we validate the hypothesis of homogeneity of variance.</p>
<p><strong>Independence</strong></p>
<p>A linear model assumes that the statistical units studied, and their associated residuals, are independent of each other. This independence must be taken into account during the research design phase. In this study, measurements for each penguin were taken over three years in a large penguin colony; we can therefore consider the observations to be independent.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1><strong>DISCUSSION</strong></h1>
<p>Our model reveals that penguin body mass is strongly associated with several morphological traits. Flipper length, bill depth, and bill length all show positive effects, with flipper length being the strongest predictor. Sex also contributes significantly, with males generally heavier than female. We can also identify species differences : Gentoo penguins are substantially heavier than Adelie and Chinstraps. Additionally, the negative interaction between species and sex (especially for Gentoo penguins) suggests species-specific patterns of sexual dimorphism that have a significant effect on body mass.</p>
<p>These results are consistent with the literature : morphological traits such as flipper length and bill depth are known to scale positively with structural size in penguins, and species-level differences in body mass, particularly the larger size of Gentoo penguins, have been documented (<span class="citation" data-cites="Williams1995">Williams (<a href="#ref-Williams1995" role="doc-biblioref">1995</a>)</span>).</p>
<p>Some effects are weaker or non-significant, such as the Gentoo × male interaction or the bill depth × sex interaction, which may reflect either natural biological variation or other possibilities. Importantly, our model does not include ecological or temporal, or individual-condition covariates, even though body mass may vary with season, breeding stage, and foraging success. This suggests that while morphology and species identity explain much of the variation, other ecological factors are likely to contribute to differences in body mass among penguins.</p>
</section>
<section id="conclusion" class="level1">
<h1><strong>CONCLUSION</strong></h1>
<p>In summary, these results provide evidence that body mass in penguins is strongly predicted by some morphological traits, particularly flipper length, bill length and bill depth. Species and sex also contribute to variation in body mass. However, substantial unexplained variation suggests that additional factors also influence penguin body mass but are not captured by our model.</p>
<p>Using a <strong>General Linear Model</strong> helped us answering the question we initially formulated quite well.</p>
<p>Thank you for reading. We hope this reminder on <strong>General Linear Models</strong>, with this example, has been helpful. We wish you all the best.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/penguin2.jpg" class="img-fluid figure-img"></p>
<figcaption>Gentoo penguins : adult and juveniles - image from Pixabay</figcaption>
</figure>
</div>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">REFERENCES</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Gorman2014" class="csl-entry" role="listitem">
Gorman, Kristen B, Tony D Williams, and William R Fraser. 2014. <span>“Ecological Sexual Dimorphism and Environmental Variability Within a Community of Antarctic Penguins (Genus Pygoscelis).”</span> <em>PLOS ONE</em> 9 (3): 1–14. <a href="https://doi.org/10.1371/journal.pone.0090081">https://doi.org/10.1371/journal.pone.0090081</a>.
</div>
<div id="ref-Horst2020" class="csl-entry" role="listitem">
Horst, Allison Marie, Alison Presmanes Hill, and Kristen B Gorman. 2020. <em>Palmerpenguins: Palmer Archipelago (Antarctica) Penguin Data</em>. <a href="https://doi.org/10.5281/zenodo.3960218">https://doi.org/10.5281/zenodo.3960218</a>.
</div>
<div id="ref-A_Masson" class="csl-entry" role="listitem">
Masson, Abel. n.d. <a href="https://github.com/AbelMasson" class="uri">https://github.com/AbelMasson</a>. Accessed November 30, 2025.
</div>
<div id="ref-Y_Outreman" class="csl-entry" role="listitem">
Outreman, Yannick. n.d. <a href="https://sites.google.com/site/yannickoutreman/home" class="uri">https://sites.google.com/site/yannickoutreman/home</a>. Accessed November 30, 2025.
</div>
<div id="ref-Williams1995" class="csl-entry" role="listitem">
Williams, T. D. 1995. <em>The Penguins: Spheniscidae</em>. Bird Families of the World. Oxford University Press. <a href="https://books.google.fr/books?id=cHMXAQAAIAAJ">https://books.google.fr/books?id=cHMXAQAAIAAJ</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>