---
title: "MODELES LINEAIRES G√âN√âRALIS√âS"
subtitle: "EXEMPLE DU BLAIREAU"
format: html
editor: visual
---

# MODELE LINERAIRE G√âN√âRALIS√â

# \## 1) Introduction

# MODELE LINERAIRE G√âN√âRALIS√â

#### a. G√©n√©ralit√©s et rappels

Rappel : Les mod√®les lin√©aires g√©n√©raux (r√©gression lin√©aire, ANOVA, ANCOVA) sont utilis√©s pour mod√©liser la relation entre une variable r√©ponse quantitative $Y$ et une ou plusieurs variables explicatives $X_{1}$,$X_{2}$...$X_{p}$, quantitatives et/ou qualitatives. Les trois conditions d'application associ√©es sont *l'ind√©pendance des r√©sidus*, *la normalit√© des r√©sidus* et *l'homog√©n√©it√© des variances*. Cependant, nous analysons souvent des r√©ponses $Y$ qui peuvent √™tre discr√®tes et s'√©carter alors de l'hypoth√®se gaussienne.

Les comptages et les donn√©es binaires (r√©ponses $Y$ discr√®tes), pr√©sentent g√©n√©ralement une relation moyenne-variance telle que la variance de $Y$ varie avec la moyenne de $Y$. Cette relation moyenne-variance sugg√®re que la variance ne peut donc pas √™tre homog√®ne car elle d√©pend de la moyenne alors que les mod√®les lin√©aires g√©n√©raux ont pour hypoth√®se d'application une homog√©n√©it√© de la variance. En conclusion, l'utilisation d'un mod√®le lin√©aire g√©n√©ral sur des r√©ponses discr√®tes g√©n√®re le plus souvent des √©carts par rapport aux conditions d'application. C'est dans ce contexte qu'ont √©t√© introduit les mod√®les li√©naires g√©n√©ralis√©s.

#### b. Construction d'un mod√®le lin√©aire g√©n√©ralis√©

La construction d'un mod√®le lin√©aire g√©n√©ralis√© (GLM) se d√©compose en trois √©tapes :\
1. L'hypoth√®se de la loi de distribution de la variable r√©ponse $Y_{i}$\
2. La sp√©cification de la partie syst√©matique : il s'agit de la fonction lin√©aire des variables explicatives $X_s$ (appel√© le pr√©dicteur lin√©aire et not√© $\eta$)\
3. La relation entre la valeur moyenne de $Y_{i}$ et le pr√©dicteur lin√©aire. On l'appelle √©galement le lien entre la moyenne et le pr√©dicteur lin√©aire : **la fonction de lien not√©e** $g$.

En cons√©quence, un mod√®le lin√©aire g√©n√©ralis√© (GLM) repose sur les hypoth√®ses suivantes :\
1. Les observ√©es $Y$ sont ind√©pendantes, conditionnellement √† certains pr√©dicteurs $X$.\
2. La r√©ponse $Y$ provient d'une distribution connue avec une relation moyenne-variance connue.\
3. Il existe une relation lin√©aire entre une fonction connue $g$ de la moyenne de $Y$ et les pr√©dicteurs $X$.

Ainsi, une mod√®le lin√©aire g√©n√©ralis√© s'√©crit de la mani√®re suivante : $$g(\mu_{y})= \alpha+ \beta_{1}.X_{i1}+ \beta_{2}.X_{i2}+\beta_{3}.X_{i3}+...\beta_{p}.X_{ip} = \eta $$

Le pr√©dicteur lin√©aire, $\eta$, est issu du mod√®le lin√©aire comme la somme des $p$ termes associ√©s √† chacun des param√®tres $\beta_{p}$. Il ne s'agit pas de la valeur de $Y$. La valeur du pr√©dicteur lin√©aire $\eta$ est obtenue en transformant la valeur de $Y$ par la fonction de lien, et la valeur pr√©dite de $Y$ est obtenue en appliquant √† $\eta$ la fonction inverse de la fonction de lien .

::: {style="text-align: justify"}
## Pr√©sentation des donn√©es

Les donn√©es utilis√©es sont issues de Zuur *et al*. (2019), et sont constitu√©es des signes d'activit√© de blaireaux (*Meles meles*) autour d'exploitations agricoles situ√©es dans le sud-ouest de l'Angleterre, o√π la densit√© de blaireaux est importante. Cette √©tude a √©t√© r√©alis√©e dans le contexte de la tuberculose bovine, et de sa possible transmission au b√©tail par l'interm√©diaire des blaireaux. La r√©duction du nombre de visites des exploitations agricoles par les blaireaux, particuli√®rement aux endroits o√π ils pourraient entrer en contact avec le b√©tail, pourrait permettre de limiter la transmission de la maladie. Ainsi, cette √©tude a pour objectif la pr√©diction de l'occurence des signes d'activit√© des blaireaux dans les exploitations agricoles.

Entre l'automne 2003 et l'√©t√© 2005, une enqu√™te a √©t√© men√©e dans 36 exploitations diff√©rentes : les donn√©es sont ainsi longitudinales, puisque chaque exploitation a √©t√© analys√©e sur 8 saisons cons√©cutives. Au sein d'une m√™me exploitation, les observations peuvent √™tre temporellement autocorr√©l√©es.

La variable r√©ponse (pr√©sence ou absence de signes d'activit√© de blaireaux) est binaire : elle prend la valeur 1 quand des signes d'activit√© ont √©t√© d√©tect√©s, et 0 sinon. Les signes d'activit√© incluent la pr√©sence de f√®ces, de blaireauti√®res ou encore de traces d'alimentation.

Les donn√©es sont disponibles dans le fichier `BadgersFarmSurveysNoNA.txt`. Les variables sont :

-   `Year` : ann√©e d'√©tude
-   `Season` : 1 = printemps, 2 = √©t√©, 3 = automne, 4 = hiver
-   `farm_code_numeric` : identifiant de l'exploitation
-   `Survey` : code du relev√© (indicateur du temps)
-   `Signs_in_yard` : indicateur binaire de l'activit√© des blaireaux (variable r√©ponse)
-   `No_setts_in_fields` : nombre de blaireauti√®res observ√©es
-   `No_active_setts_in_fields` : nombre de blaireauti√®res activement utilis√©es observ√©es
-   `No_buildings` : nombre de b√¢timents dans l'exploitation
-   `No_cattle_in_buildings_yard` : nombre de bovins dans les b√¢timents de l'exploitation
-   `Accessible_feed_store_present` : pr√©sence / absence d'une r√©serve d'alimentation animale dans l'exploitation
-   `Accessible_cattle_house_present` : pr√©sence / absence d'un acc√®s direct √† l'√©table
-   `Accessible_feed_present` : pr√©sence / absence d'aliments accessibles dans l'exploitation
-   `Grass_silage` : pr√©sence / absence d'ensilage herbe
-   `Cereal_silage` : pr√©sence / absence d'ensilage c√©r√©ale
-   `HayStraw` : pr√©sence / absence de foin et / ou de paille
-   `Cereal_grains` : pr√©sence / absence de grains de c√©r√©ales
-   `Concentrates` : pr√©sence / absence de concentr√©s
-   `Proteinblocks` : pr√©sence / absence de blocs √† l√©cher prot√©in√©s
-   `Sugarbeet` : pr√©sence / absence de betterave sucri√®re
-   `Vegetables` : pr√©sence / absence de l√©gumes
-   `Molasses` : pr√©sence / absence de m√©lasse
:::

## Exploration des donn√©es

```{r}
data <- read.table("BadgersFarmSurveysNoNA.txt", header = TRUE,  stringsAsFactors = TRUE)
```

```{r}
library(dplyr)

data <- data %>%
  group_by(farm_code_numeric) %>%
  mutate(mean_signs_farm = mean(Signs_in_yard, na.rm = TRUE)) %>%
  ungroup()

data <- data %>%
  group_by(farm_code_numeric) %>%
  mutate(mean_cereal_farm = mean(Cereal_grains, na.rm = TRUE)) %>%
  ungroup()
```

```{r}
library(ggplot2)

# R√©sum√© : une ligne par ferme
data_summary <- data %>%
  select(farm_code_numeric, mean_signs_farm, mean_cereal_farm) %>%
  distinct()

# Plot
ggplot(data_summary, aes(x = farm_code_numeric, y = mean_signs_farm)) +
  # Points
  geom_point(color = "#0072B2", size = 3) +
  
  # √âtiquettes pour fermes avec moyenne > 0
  geom_text(
    data = subset(data_summary, mean_signs_farm > 0),
    aes(label = farm_code_numeric),
    nudge_y = 0.05,  # üîº d√©calage vers le haut
    color = "black",
    size = 3.2,
    fontface = "bold"
  ) +

  # Th√®me clair et √©pur√©
  theme_minimal(base_size = 12) +
  
  theme(
  axis.title.y = element_text(size = 9)  # Ajuste la taille ici
)+
  
  # Titres
  labs(
    title = "Pr√©sence moyenne des blaireaux par ferme",
    x = "Num√©ro de ferme",
    y = "Pr√©sence moyenne des blaireaux (pr√©sence/abscence par saison)"
  ) +
  
  # Axes plus lisibles
  scale_x_continuous(breaks = unique(data_summary$farm_code_numeric)) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```

```{r}
plot(x= data_summary$farm_code_numeric , y=data_summary$mean_cereal_farm)
```
