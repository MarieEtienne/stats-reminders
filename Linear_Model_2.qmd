---
title: "Blaireau"
format: html
editor: visual
---

::: {style="text-align: justify"}
## Pr√©sentation des donn√©es

Les donn√©es utilis√©es sont issues de Zuur *et al*. (2019), et sont constitu√©es des signes d'activit√© de blaireaux (*Meles meles*) autour d'exploitations agricoles situ√©es dans le sud-ouest de l'Angleterre, o√π la densit√© de blaireaux est importante. Cette √©tude a √©t√© r√©alis√©e dans le contexte de la tuberculose bovine, et de sa possible transmission au b√©tail par l'interm√©diaire des blaireaux. La r√©duction du nombre de visites des exploitations agricoles par les blaireaux, particuli√®rement aux endroits o√π ils pourraient entrer en contact avec le b√©tail, pourrait permettre de limiter la transmission de la maladie. Ainsi, cette √©tude a pour objectif la pr√©diction de l'occurence des signes d'activit√© des blaireaux dans les exploitations agricoles.

Entre l'automne 2003 et l'√©t√© 2005, une enqu√™te a √©t√© men√©e dans 36 exploitations diff√©rentes : les donn√©es sont ainsi longitudinales, puisque chaque exploitation a √©t√© analys√©e sur 8 saisons cons√©cutives. Au sein d'une m√™me exploitation, les observations peuvent √™tre temporellement autocorr√©l√©es.

La variable r√©ponse (pr√©sence ou absence de signes d'activit√© de blaireaux) est binaire : elle prend la valeur 1 quand des signes d'activit√© ont √©t√© d√©tect√©s, et 0 sinon. Les signes d'activit√© incluent la pr√©sence de f√®ces, de blaireauti√®res ou encore de traces d'alimentation.

Les donn√©es sont disponibles dans le fichier `BadgersFarmSurveysNoNA.txt`. Les variables sont :

-   `Year` : ann√©e d'√©tude
-   `Season` : 1 = printemps, 2 = √©t√©, 3 = automne, 4 = hiver
-   `farm_code_numeric` : identifiant de l'exploitation
-   `Survey` : code du relev√© (indicateur du temps)
-   `Signs_in_yard` : indicateur binaire de l'activit√© des blaireaux (variable r√©ponse)
-   `No_setts_in_fields` : nombre de blaireauti√®res observ√©es
-   `No_active_setts_in_fields` : nombre de blaireauti√®res activement utilis√©es observ√©es
-   `No_buildings` : nombre de b√¢timents dans l'exploitation
-   `No_cattle_in_buildings_yard` : nombre de bovins dans les b√¢timents de l'exploitation
-   `Accessible_feed_store_present` : pr√©sence / absence d'une r√©serve d'alimentation animale dans l'exploitation
-   `Accessible_cattle_house_present` : pr√©sence / absence d'un acc√®s direct √† l'√©table
-   `Accessible_feed_present` : pr√©sence / absence d'aliments accessibles dans l'exploitation
-   `Grass_silage` : pr√©sence / absence d'ensilage herbe
-   `Cereal_silage` : pr√©sence / absence d'ensilage c√©r√©ale
-   `HayStraw` : pr√©sence / absence de foin et / ou de paille
-   `Cereal_grains` : pr√©sence / absence de grains de c√©r√©ales
-   `Concentrates` : pr√©sence / absence de concentr√©s
-   `Proteinblocks` : pr√©sence / absence de blocs √† l√©cher prot√©in√©s
-   `Sugarbeet` : pr√©sence / absence de betterave sucri√®re
-   `Vegetables` : pr√©sence / absence de l√©gumes
-   `Molasses` : pr√©sence / absence de m√©lasse
:::
=======
```{r}
data <- read.table("BadgersFarmSurveysNoNA.txt", header = TRUE)
```

```{r}
library(dplyr)

data <- data %>%
  group_by(farm_code_numeric) %>%
  mutate(mean_signs_farm = mean(Signs_in_yard, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
library(ggplot2)
library(dplyr)

# R√©sum√© : une ligne par ferme
data_summary <- data %>%
  select(farm_code_numeric, mean_signs_farm) %>%
  distinct()

# Plot
ggplot(data_summary, aes(x = farm_code_numeric, y = mean_signs_farm)) +
  # Points
  geom_point(color = "#0072B2", size = 3) +
  
  # √âtiquettes pour fermes avec moyenne > 0
  geom_text(
    data = subset(data_summary, mean_signs_farm > 0),
    aes(label = farm_code_numeric),
    nudge_y = 0.05,  # üîº d√©calage vers le haut
    color = "black",
    size = 3.2,
    fontface = "bold"
  ) +

  # Th√®me clair et √©pur√©
  theme_minimal(base_size = 12) +
  
  theme(
  axis.title.y = element_text(size = 9)  # Ajuste la taille ici
)+
  
  # Titres
  labs(
    title = "Pr√©sence moyenne des blaireaux par ferme",
    x = "Num√©ro de ferme",
    y = "Pr√©sence moyenne des blaireaux (pr√©sence/abscence par saison)"
  ) +
  
  # Axes plus lisibles
  scale_x_continuous(breaks = unique(data_summary$farm_code_numeric)) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```
