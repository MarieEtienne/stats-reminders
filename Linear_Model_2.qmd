---
title: "Blaireau"
format: html
editor: visual
---

```{r}
data <- read.table("BadgersFarmSurveysNoNA.txt", header = TRUE)
```

```{r}
library(dplyr)

data <- data %>%
  group_by(farm_code_numeric) %>%
  mutate(mean_signs_farm = mean(Signs_in_yard, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
library(ggplot2)
library(dplyr)

# R√©sum√© : une ligne par ferme
data_summary <- data %>%
  select(farm_code_numeric, mean_signs_farm) %>%
  distinct()

# Plot
ggplot(data_summary, aes(x = farm_code_numeric, y = mean_signs_farm)) +
  # Points
  geom_point(color = "#0072B2", size = 3) +
  
  # √âtiquettes pour fermes avec moyenne > 0
  geom_text(
    data = subset(data_summary, mean_signs_farm > 0),
    aes(label = farm_code_numeric),
    nudge_y = 0.05,  # üîº d√©calage vers le haut
    color = "black",
    size = 3.2,
    fontface = "bold"
  ) +

  # Th√®me clair et √©pur√©
  theme_minimal(base_size = 12) +
  
  theme(
  axis.title.y = element_text(size = 9)  # Ajuste la taille ici
)+
  
  # Titres
  labs(
    title = "Pr√©sence moyenne des blaireaux par ferme",
    x = "Num√©ro de ferme",
    y = "Pr√©sence moyenne des blaireaux (pr√©sence/abscence par saison)"
  ) +
  
  # Axes plus lisibles
  scale_x_continuous(breaks = unique(data_summary$farm_code_numeric)) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```
