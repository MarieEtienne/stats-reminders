---
title: "Penguins"
format: html
editor: visual
---

# General Linear Model

We present here, a reminder sheet on the General Linear Model (GLM) and its specific features. Its use will be illustrated through an example applied to ecological data on penguins.

Remark : the concepts covered in this reminder sheet are taken from our Master's courses and tutorials, written and taught by several professors (A. Masson and Y. Outreman). During these courses, we learned how to explore data and then analyze it using this type of model (ajouter la référence).

The objective of the GLM is to explain a dependent variable as a function of independent explanatory variables measured on statistical units from a sample of a population. This type of model is generally constructed as follows:

Y = β\*X + ε

Y is the response (dependent) variable to be explained. X is an explanatory (independent) variable that can explain Y. There can be several in the model. βi represents a coefficient, placed in front of the X variables, to measure their effect on the response variable. ε represents the errors in the model, i.e., what the model cannot explain.

There are three general types of linear models:

-   Linear regression
-   Analysis of variance (ANOVA)
-   Analysis of variance-covariance (ANCOVA)

They each have their own specificities and depend on the nature of the independent variables X, which can be quantitative or qualitative. The response variable Y is always quantitative.

Linear regression is used when we want to determine whether a linear relationship exists between the response variable Y and one or more quantitative X variables (then called covariates).

ANOVA is used when the explanatory variables X are qualitative (then called factors). These qualitative X variables often have multiple categories called modalities.

ANCOVA is used when we want to model the variable Y as a function of several X variables, which can be qualitative and quantitative.

Choosing the right model therefore requires knowing the type of variables we wish to study before beginning the modeling process.

Another important aspect to consider is that for this type of model to be valid, three conditions must be met:

The errors (residuals) must follow a normal distribution; the principle of homoscedasticity (homogeneity of the variance of the residuals) must be respected; the residuals are uncorrelated and independent.

These conditions are systematically verified after modeling: the application of this verification will be illustrated in the chosen example.

# II) Data exploration

```{r}
#Data importation
library(palmerpenguins)
data("penguins")
penguins$sex<-as.factor(penguins$sex)
penguins$species<-as.factor(penguins$species)
penguins$island<-as.factor(penguins$island)
str(penguins)
```

```{r}
#Is NA? 
colSums(is.na(penguins))
```

There is NA values in the data set.

```{r}
par(mfrow=c(2,2))
# Boxplot
boxplot(penguins$bill_depth_mm,col='aquamarine3',ylab='Bill depth')
# Cleveland plot
dotchart(penguins$bill_depth_mm,pch=16,col='aquamarine3',xlab='Bill depth')
# Histogram
hist(penguins$bill_depth_mm,col='aquamarine3',xlab="Bill depth",main="")
# Quantile-Quantile plot
qqnorm(penguins$bill_depth_mm,pch=16,col='aquamarine3',xlab='')
qqline(penguins$bill_depth_mm,col='red',lwd=2)
```

There is no outlier in Y and Y distribution.

```{r}
par(mfrow = c(1, 3))

# Bill lenght 
# Cleveland plot
dotchart(penguins$bill_length_mm,pch=16,col='aquamarine3',xlab='Bill Length')
# Histogram
hist(penguins$bill_length_mm,col='aquamarine3',xlab="Bill Length",main="")
# Quantile-Quantile plot
qqnorm(penguins$bill_length_mm,pch=16,col='aquamarine3',xlab='')
qqline(penguins$bill_length_mm,col='red',lwd=2)

# Flipper lenght 
# Cleveland plot
dotchart(penguins$flipper_length_mm,pch=16,col='aquamarine3',xlab='Flipper Lenght')
# Histogram
hist(penguins$flipper_length_mm,col='aquamarine3',xlab="Flipper Lenght",main="")
# Quantile-Quantile plot
qqnorm(penguins$flipper_length_mm,pch=16,col='aquamarine3',xlab='')
qqline(penguins$flipper_length_mm,col='red',lwd=2)

# Body mass
# Cleveland plot
dotchart(penguins$body_mass_g,pch=16,col='aquamarine3',xlab='Body Mass')
# Histogram
hist(penguins$body_mass_g,col='aquamarine3',xlab="Body Mass",main="")
# Quantile-Quantile plot
qqnorm(penguins$body_mass_g,pch=16,col='aquamarine3',xlab='')
qqline(penguins$body_mass_g,col='red',lwd=2)
```

There is no outlier in X and X distribution.

```{r}
summary(penguins$species)
summary(penguins$island)
summary(penguins$sex)
```

Some groups are under-represented, in the island and species groups.
